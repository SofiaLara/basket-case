{"ast":null,"code":"import _toConsumableArray from\"/Users/sofiapeyret/Desktop/cct-eng-SofiaLara-1/itv/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/sofiapeyret/Desktop/cct-eng-SofiaLara-1/itv/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback,useContext}from'react';import{ProductDataContext}from'../../stores/useProductData';import'./OrderTable.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OrderTable(_ref){var setSubTotal=_ref.setSubTotal;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),hasChanged=_useState2[0],setHasChanged=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),quantity=_useState4[0],setQuantity=_useState4[1];var _useContext=useContext(ProductDataContext),productData=_useContext.productData,setProductData=_useContext.setProductData;//Initialise with default quantities\nuseEffect(function(){if(productData&&productData.length>0&&!hasChanged){setQuantity(productData.map(function(){return 1;}));}},[hasChanged,productData]);//increases the quantites number and set it the correspondent object\nvar handleIncrease=function handleIncrease(i){setHasChanged(true);setQuantity(function(prevQuantities){var newQuantities=_toConsumableArray(prevQuantities);newQuantities[i]+=1;return newQuantities;});setProductData(function(prevData){var newData=_toConsumableArray(prevData);newData[i].quantity=quantity[i]+1;return newData;});};//decreases the quantites number and set it the correspondent object\nvar handleDecrease=function handleDecrease(i){setHasChanged(true);setQuantity(function(prevQuantities){var newQuantities=_toConsumableArray(prevQuantities);if(newQuantities[i]>1){newQuantities[i]-=1;}return newQuantities;});setProductData(function(prevData){var newData=_toConsumableArray(prevData);newData[i].quantity=quantity[i]-1;return newData;});};//deletes quantities and item from product data\nvar handleDelete=function handleDelete(i){setHasChanged(true);setQuantity(function(prevQuantities){var newQuantities=_toConsumableArray(prevQuantities);newQuantities.splice(i,1);return newQuantities;});setProductData(function(prevData){var newData=_toConsumableArray(prevData);newData.splice(i,1);return newData;});};var calculateCost=function calculateCost(price,quantity){return(price*quantity).toFixed(2);};//calculate subtotal prices and set it in the context\nvar calculateSubTotal=useCallback(function(){var total=0;if(productData&&productData.length>0){for(var i=0;i<productData.length;i++){total+=productData[i].price*quantity[i];}setSubTotal(parseFloat(total.toFixed(2)));}if(quantity.length===0){setSubTotal(0);}},[productData,quantity,setSubTotal]);useEffect(function(){calculateSubTotal();},[calculateSubTotal,quantity]);return/*#__PURE__*/_jsx(\"tbody\",{children:productData&&productData.length>0&&productData.map(function(item,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.product}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\xA3\",item.price]}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"span\",{\"data-testid\":\"quantity-cell\",children:quantity[i]}),/*#__PURE__*/_jsx(\"button\",{type:\"plus\",onClick:function onClick(){return handleIncrease(i);},className:\"btn btn__plus\",\"data-testid\":\"plus-button\",children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{type:\"minus\",onClick:function onClick(){return handleDecrease(i);},className:\"btn btn__minus\",\"data-testid\":\"minus-button\",children:\"-\"})]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\xA3\",calculateCost(item.price,quantity[i])]}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:/*#__PURE__*/_jsx(\"button\",{type:\"delete\",onClick:function onClick(){return handleDelete(i);},className:\"btn btn__delete\",\"data-testid\":\"delete-button\",children:\"Delete\"})})]},i);})});}export default OrderTable;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useContext","ProductDataContext","jsx","_jsx","jsxs","_jsxs","OrderTable","_ref","setSubTotal","_useState","_useState2","_slicedToArray","hasChanged","setHasChanged","_useState3","_useState4","quantity","setQuantity","_useContext","productData","setProductData","length","map","handleIncrease","i","prevQuantities","newQuantities","_toConsumableArray","prevData","newData","handleDecrease","handleDelete","splice","calculateCost","price","toFixed","calculateSubTotal","total","parseFloat","children","item","product","type","onClick","className"],"sources":["/Users/sofiapeyret/Desktop/cct-eng-SofiaLara-1/itv/src/components/OrderTable/OrderTable.js"],"sourcesContent":["import React, {useState, useEffect, useCallback, useContext} from 'react'\nimport PropTypes from 'prop-types'\nimport { ProductDataContext } from '../../stores/useProductData'\nimport './OrderTable.css'\n\nfunction OrderTable({setSubTotal}) {\n  const [hasChanged, setHasChanged] = useState(false)\n  const [quantity, setQuantity] = useState([])\n  const {productData, setProductData} = useContext(ProductDataContext)\n\n  //Initialise with default quantities\n  useEffect(() => {\n    if (productData && productData.length > 0 && !hasChanged) {\n      setQuantity(productData.map(() => 1))\n    }\n  }, [hasChanged, productData])\n\n  //increases the quantites number and set it the correspondent object\n  const handleIncrease = (i) => {\n    setHasChanged(true)\n    setQuantity((prevQuantities) => {\n      const newQuantities = [...prevQuantities]\n      newQuantities[i] += 1\n      return newQuantities\n    });\n    setProductData((prevData) => {\n      const newData = [...prevData]\n      newData[i].quantity = quantity[i] + 1\n      return newData\n    });\n  };\n\n  //decreases the quantites number and set it the correspondent object\n  const handleDecrease = (i) => {\n    setHasChanged(true)\n    setQuantity((prevQuantities) => {\n      const newQuantities = [...prevQuantities]\n      if (newQuantities[i] > 1) {\n        newQuantities[i] -= 1\n      }\n      return newQuantities\n    });\n    setProductData((prevData) => {\n      const newData = [...prevData]\n      newData[i].quantity = quantity[i] - 1\n      return newData\n    });\n  };\n\n  //deletes quantities and item from product data\n  const handleDelete = (i) => {\n    setHasChanged(true)\n    setQuantity((prevQuantities) => {\n      const newQuantities = [...prevQuantities]\n      newQuantities.splice(i, 1)\n      return newQuantities\n    });\n    setProductData((prevData) => {\n      const newData = [...prevData]\n      newData.splice(i, 1)\n      return newData\n    });\n  };\n\n  const calculateCost = (price, quantity) => {\n    return (price * quantity).toFixed(2)\n  };\n\n  //calculate subtotal prices and set it in the context\n  const calculateSubTotal = useCallback(() => {\n    let total = 0;\n\n    if (productData && productData.length > 0) {\n        for (let i = 0; i < productData.length; i++) {\n          total += productData[i].price * quantity[i]\n        }\n\n        setSubTotal(parseFloat(total.toFixed(2)))\n    }\n\n    if(quantity.length === 0) {\n      setSubTotal(0)\n    }\n  }, [productData, quantity, setSubTotal]);\n\n  useEffect(() => {\n    calculateSubTotal()\n  }, [calculateSubTotal, quantity])\n\n  return (\n    <tbody>\n            {productData && productData.length > 0 && productData.map((item, i) => (\n                <tr key={i}>\n                    <td>{item.product}</td>\n                    <td>£{item.price}</td>\n                    <td>\n                        <span data-testid=\"quantity-cell\">{quantity[i]}</span>\n                        <button\n                            type=\"plus\"\n                            onClick={() => handleIncrease(i)}\n                            className='btn btn__plus'\n                            data-testid=\"plus-button\"\n                        >+</button>\n                        <button\n                            type=\"minus\"\n                            onClick={() => handleDecrease(i)}\n                            className='btn btn__minus'\n                            data-testid=\"minus-button\"\n                        >-</button>\n                    </td>\n                    <td>£{calculateCost(item.price, quantity[i])}</td>\n                    <td className='right'><button\n                        type=\"delete\"\n                        onClick={() => handleDelete(i)}\n                        className='btn btn__delete'\n                        data-testid=\"delete-button\"\n                    >Delete</button></td>\n                </tr>\n            ))}\n    </tbody>     \n    )\n}\n\nexport default OrderTable;\n\nOrderTable.propTypes= {\n  setSubTotal: PropTypes.func.isRequired,\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}